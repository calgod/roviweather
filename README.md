### Note from the Editor

This project was initially created with assistance from OpenAI GPT-5.3-Codex via the Codex desktop app. A mix of medium and high level reasoning was used. This was my first time using Codex, and I’m fairly pleased with it. It's great at generating boilerplate and getting an MVP out quickly, though the returns (seem to) diminish a bit beyond that. Still, I was essentially able to create this without writing any code myself, which impressed me with how customized I was making things.

Codex occasionally introduced visual bugs/inconsistencies but caused no other major issues. It isn’t strong at design and often required extra prompting to follow UI/UX principles. The rest of this README is generated by Codex!

# RoviWeather

RoviWeather is a React + TypeScript + Vite app that shows current weather across RoviSys office locations, with a Cloudflare Worker proxy in front of OpenWeatherMap.

## Tech Stack

- Frontend: React, TypeScript, Vite, TailwindCSS, Leaflet (`react-leaflet`)
- Backend proxy: Cloudflare Worker
- Weather source: OpenWeatherMap `data/2.5/weather`

## Project Structure

- `src/` - frontend app
- `src/components/` - UI components (`OfficeList`, `WeatherCard`, `MapView`)
- `src/hooks/useWeather.ts` - worker fetch + normalization
- `src/data/offices.ts` - office data (coordinates, address, image)
- `worker/` - Cloudflare Worker (`/weather?lat=<lat>&lon=<lon>`)

## Features

- Searchable office list
- Favorites (star icon) persisted in `localStorage`, shown first
- Per-office weather details:
  - temperature (selectable `°F` / `°C`)
  - condition + icon
  - humidity
  - wind speed (selectable `mph` / `m/s` / `km/h`)
  - local current time (office timezone)
- Theme support:
  - defaults to system preference (light/dark)
  - user-toggleable, persisted in `localStorage`
- Interactive map:
  - markers for all offices
  - clicking a card focuses map marker + opens popup
  - popup includes clickable address (opens Google Maps)
- Worker-side 10 minute caching via `caches.default`

## Local Development

### 1. Start Worker

```bash
cd worker
npm install
```

Set local worker secret:

```bash
echo 'OPENWEATHER_API_KEY=your_openweather_api_key' > .dev.vars
```

Run worker:

```bash
npm run dev
```

Worker default URL: `http://localhost:8787`

### 2. Start Frontend

```bash
cd ..
npm install
npm run dev
```

Frontend reads API base from `.env`:

```env
VITE_WEATHER_API_BASE=http://localhost:8787
```

## Deployment

### Deploy Worker

```bash
cd worker
npx wrangler login
npx wrangler secret put OPENWEATHER_API_KEY
npm run deploy
```

### Deploy Frontend

Create local production env (do not commit):

```bash
cd ..
printf "VITE_WEATHER_API_BASE=%s\n" "https://<your-worker>.workers.dev" > .env.production
```

Build and deploy (example Cloudflare Pages):

```bash
npm run build
npx wrangler pages project create roviweather
npx wrangler pages deploy dist --project-name roviweather
```

## Environment Files

- `.env` - local frontend config
- `.env.production` - local production frontend config (gitignored)
- `.env.production.example` - committed template
- `worker/.dev.vars` - local worker secrets (not committed)

## Troubleshooting

### `500` from Worker

Usually means missing worker secret.

Check:

- `worker/.dev.vars` includes `OPENWEATHER_API_KEY=...`
- worker is running on `http://localhost:8787`

Test worker directly:

```bash
curl "http://localhost:8787/weather?lat=41.27814&lon=-81.3289235"
```

### `502` from Worker

Usually upstream auth/config issue with OpenWeatherMap (invalid key, key not active yet, or upstream error).

## Notes

- Worker endpoint only supports `GET /weather?lat=<lat>&lon=<lon>`
- API key is stored in Cloudflare Worker secrets, not in frontend code
- This website is an independent project and is not affiliated with, endorsed by, or sponsored by The RoviSys Company.
